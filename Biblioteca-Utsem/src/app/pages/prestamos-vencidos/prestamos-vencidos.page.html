<ion-content class="ion-padding">
  <div class="container">
    <h1 class="titulo-principal">PRÉSTAMOS VENCIDOS</h1>

    <!-- Filtros -->
    <div class="filtros-container">
      
      <div class="filtro-item">
        <ion-label class="filtro-label">Fecha Préstamo:</ion-label>
        <ion-input [(ngModel)]="fechaPrestamo" type="date" class="custom-input"></ion-input>
      </div>

      <div class="filtro-item">
        <ion-label class="filtro-label">Alumno:</ion-label>
        <ion-select [(ngModel)]="alumnoSeleccionado" interface="popover">
          <ion-select-option value="">Seleccionar Alumno</ion-select-option>
          <ion-select-option *ngFor="let alumno of alumnos" [value]="alumno">
            {{ alumno }}
          </ion-select-option>
        </ion-select>
      </div>

      <div class="filtro-item">
        <ion-label class="filtro-label">Libro:</ion-label>
        <ion-select [(ngModel)]="libroSeleccionado" interface="popover">
          <ion-select-option value="">Seleccionar Libro</ion-select-option>
          <ion-select-option *ngFor="let libro of libros" [value]="libro">
            {{ libro }}
          </ion-select-option>
        </ion-select>
      </div>

      <div class="boton-buscar-container">
        <ion-button class="btn-buscar" (click)="buscarPrestamos()">Buscar</ion-button>
        <ion-button class="btn-buscar" (click)="limpiarFiltros()">Limpiar</ion-button>
      </div>
    </div>

    <!-- GRID DE PRÉSTAMOS -->
    <ion-grid class="prestamos-grid">
      <ion-row>
        <ion-col size="12" size-md="6" size-lg="4"
                 *ngFor="let prestamo of prestamosPaginados">
          <ion-card class="prestamo-card">
            <ion-card-content>
              
              <h2 class="libro-titulo">{{ prestamo.libroTitulo }}</h2>

              <div class="separador"></div>

              <div class="info-prestamo">
                <p><strong>Matrícula:</strong> {{ prestamo.matricula }}</p>
                <p><strong>Alumno:</strong> 
                  {{ prestamo.alumnoNombre }} {{ prestamo.apellidoPaterno }} {{ prestamo.apellidoMaterno }}
                </p>
                <p><strong>Carrera:</strong> {{ prestamo.carreraNombre }}</p>
                <p><strong>Fecha Préstamo:</strong> {{ prestamo.fechaPrestamo }}</p>
                <p><strong>Fecha Devolución:</strong> {{ prestamo.fechaDevolucion }}</p>
              </div>

            </ion-card-content>
          </ion-card>
        </ion-col>
      </ion-row>
    </ion-grid>

    <!-- SIN RESULTADOS -->
    <div *ngIf="prestamosFiltrados.length === 0" class="no-resultados">
      <p>No se encontraron préstamos vencidos</p>
    </div>

    <!-- PAGINADO -->
    <div class="paginacion" *ngIf="totalPaginas > 1">
      <button (click)="irPrimera()" [disabled]="paginaActual === 1">«</button>
      <button (click)="paginaAnterior()" [disabled]="paginaActual === 1">‹</button>

      <button 
        *ngFor="let pagina of paginasArray"
        [class.activa]="paginaActual === pagina"
        (click)="irPagina(pagina)"
      >
        {{ pagina }}
      </button>

      <button (click)="paginaSiguiente()" [disabled]="paginaActual === totalPaginas">›</button>
      <button (click)="irUltima()" [disabled]="paginaActual === totalPaginas">»</button>
    </div>

  </div>
</ion-content>

<app-loading></app-loading>
